<h1>Profil</h1>

<% if current_user.photo.attached? %>
  <%= cl_image_tag current_user.photo.key, height: 300, width: 400, crop: :fill %>
<% else %>
  <img src="">
<% end %>
<p><%= current_user.biography %></p>
<%= link_to "Edit my profile", edit_user_registration_path %>

<br>
<div>
  <% if current_user.clubs.count != 0 %>
    <h2>Mes clubs</h2>
    <% @clubs.each do |club| %>
      <% if club.photo.attached? %>
        <%= cl_image_tag(club.photo.key, height: 300, width: 400, crop: :fill) %>
      <% else %>
        <img src="">
      <% end %>
      <p><%= club.name %></p>
      <p><%= club.address %></p>
      <p><%= club.description %></p>
      <p>Numéro de téléphone : <%= club.phone_number %></p>
      <p>Catégorie : <%= club.category %></p>
      <p>Capacité : <%= club.capacity %></p>
      <p>Prix : <%= club.hour_price %> €</p>
      <%= link_to "Details of this club", club_path(club) %>
    <% end %>
  <% end %>
</div>
<br>

<div>
  <% if current_user.bookings.count != 0 %>
    <h2>Mes bookings</h2>
    <% @bookings.each do |booking| %>
      <h3><%= booking.club.name %></h3>
      <p>Début de la réservation : <%= booking.start_date %></p>
      <p>Fin de la réservation : <%= booking.end_date %></p>
      <p>Statut de la réservation : <%= booking.accepted %></p>
      <%= link_to "Delete", bookings_delete_path(booking), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} %>
    <% end %>
  <% end %>
</div>

<div>
  <% if current_user.clubs.count != 0 %>
    <h2>Les bookings de mes clubs</h2>
    <% current_user.clubs.each do |club| %>
      <% club.bookings.each do |booking| %>
      <h3><%= booking.club.name %></h3>
      <%= link_to "#{booking.user.first_name} #{booking.user.last_name}", user_path(booking.user) %>
      <% if booking.user.photo.attached? %>
        <%= cl_image_tag(booking.user.photo.key, height: 300, width: 400, crop: :fill) %>
      <% else %>
        <img src="">
      <% end %>
      <p>Début de la réservation : <%= booking.start_date %></p>
      <p>Fin de la réservation : <%= booking.end_date %></p>
      <p>Statut de la réservation : <%= booking.accepted %></p>
      <%= link_to "Delete", bookings_delete_path(booking), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} %>
      <%= link_to "Accept this booking", booking_accepted_path(booking) %>
      <% end %>
    <% end %>
  <% end %>
</div>
