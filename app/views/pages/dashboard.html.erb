<h1>Profil</h1>

<% if current_user.photo.attached? %>
  <%= cl_image_tag current_user.photo.key, height: 150, width: 200, :gravity=>"faces", crop: :fill %>
<% else %>
  <img src="">
<% end %>
<p><%= current_user.biography %></p>
<%= link_to "Edit my profile", edit_user_registration_path %>

<br>

<%# MES CLUBS  MES CLUBS  MES CLUBS  MES CLUBS  MES CLUBS  MES CLUBS  MES CLUBS%>

<div>
  <% if current_user.clubs.count != 0 %>
    <h2>Mes clubs</h2>

      <div class="overflowx pt-3 pb-3">
      <% @clubs.each do |club| %>
        <%= link_to club_path(club) do%>
          <div class="card-club shadow ms-3 me-3">
            <% if club.photo.attached? %>
              <%= cl_image_tag(club.photo.key, height: 200, width: 380, crop: :fill) %>
            <% else %>
              <div class="sans-photo"><%= club.name %></div>
            <% end %>

            <div class="d-flex flex-row justify-content-between align-items-center mt-2">
              <h2><%= club.name %></h2>
              <h3><%= club.category %></h3>
            </div>

            <div class="d-flex flew-row align-items-center justify-content-between mt-1">
              <div class="d-flex flex-row align-items-center">
                <p class="me-2"><strong><%= club.capacity %></strong></p>
                <i class="fa-solid fa-people-group"></i>
              </div>
              <div class="d-flex flex-row align-items-center">
                <p><strong><%= club.hour_price.round %>€</strong></p>
              </div>
            </div>

            <div class="d-flex flew-row align-items-center w-100 text-truncate mt-2">
              <i class="fa-solid fa-location-dot"></i>
              <p class="ms-2"><%= club.address %></p>
            </div>

            <div class="d-flex flew-row align-items-center justify-content-start">
              <div class="d-flex flex-row align-items-center">
                <i class="fa-solid fa-phone"></i>
                <p class="ms-2 me-4"><%= club.phone_number %></p>
              </div>
              <div class="d-flex flex-row align-items-center">
                <i class="fa-solid fa-envelope"></i>
                <p class="ms-2"><%= club.user.email %></p>
              </div>
            </div>

          </div>
        <% end %>
      <% end %>
  <% end %>
</div>
<br>

<%# MES BOOKINGS  MES BOOKINGS  MES BOOKINGS  MES BOOKINGS  MES BOOKINGS  MES BOOKINGS  MES BOOKINGS%>

<div>
  <% if current_user.bookings.count != 0 %>
    <h2>Mes bookings</h2>
      <div class="overflowx pt-3 pb-3">
      <% @bookings.each do |booking| %>
        <div class="card-booking shadow ms-3 me-3 p-2 row">
          <div class="col-10">
            <h3 class="mt-2 text-truncate"><%= booking.club.name %></h3>
            <div class="container-forced">
              <% if booking.club.user.photo.attached? %>
                <%= cl_image_tag(booking.club.user.photo.key, height: 45, width: 45,:gravity=>"faces", crop: :fill, :class=>"rounded-circle ms-1 me-2 mb-3 mt-2") %>
              <% else %>
                <%= cl_image_tag("avatar-vierge_dnx941", height: 45, width: 45,:gravity=>"faces", crop: :fill, :class=>"rounded-circle ms-1 me-2 mb-3 mt-2") %>
              <% end %>
              <%= link_to "#{booking.club.user.first_name} #{booking.club.user.last_name}", user_path(booking.club.user) %>
            </div>
            <p><strong>Début :</strong> <%= booking.start_date %></p>
            <p><strong>Fin :</strong> <%= booking.end_date %></p>
          </div>
          <div class="col-2 d-flex flex-column align-items-center justify-content-between pb-2">
              <% if booking.accepted %>
                <i class="fa-solid fa-check validated"></i>
              <% else %>
                <i class="fa-solid fa-check unvalidated"></i>
              <% end %>
            <%= link_to bookings_delete_path(booking), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} do%>
              <i class="fa-solid fa-trash"></i>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
</div>

<%# MES BOOKINGS de mes clubs  MES BOOKINGS de mes clubs  MES BOOKINGS de mes clubs %>

<div>
  <% if current_user.clubs.count != 0 %>
    <h2>Les bookings de mes clubs</h2>
    <div class="overflowx pt-3 pb-3">
      <% current_user.clubs.each do |club| %>
        <% club.bookings.each do |booking| %>
          <div class="card-booking shadow ms-3 me-3 p-2 row">
            <div class="col-10">
              <h3 class="mt-2 text-truncate"><%= booking.club.name %></h3>
              <div class="container-forced">
                <% if booking.user.photo.attached? %>
                  <%= cl_image_tag(booking.user.photo.key, height: 45, width: 45,:gravity=>"faces", crop: :fill, :class=>"rounded-circle ms-1 me-2 mb-3 mt-2") %>
                <% else %>
                  <%= cl_image_tag("avatar-vierge_dnx941", height: 45, width: 45,:gravity=>"faces", crop: :fill, :class=>"rounded-circle ms-1 me-2 mb-3 mt-2") %>
                <% end %>
                <%= link_to "#{booking.user.first_name} #{booking.user.last_name}", user_path(booking.user) %>
              </div>
              <p><strong>Début :</strong> <%= booking.start_date %></p>
              <p><strong>Fin :</strong> <%= booking.end_date %></p>
            </div>
            <div class="col-2 d-flex flex-column align-items-center justify-content-between pb-2">
              <%= link_to booking_accepted_path(booking) do%>
                <% if booking.accepted %>
                  <i class="fa-solid fa-check validated"></i>
                <% else %>
                  <i class="fa-solid fa-check unvalidated"></i>
                <% end %>
              <% end %>
              <%= link_to bookings_delete_path(booking), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} do%>
                <i class="fa-solid fa-trash"></i>
              <% end %>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  <% end %>
</div>

<%# TEST TEST TEST TEST TEST TEST TEST TEST TEST TEST TEST  %>

<div>
  <% if current_user.clubs.count != 0 %>
    <h2>Les bookings de mes clubs</h2>
    <div class="overflowx pt-3 pb-3">
      <% current_user.clubs.each do |club| %>
        <% club.bookings.each do |booking| %>
          <div class="card-booking shadow ms-3 me-3 p-2 row">
            <div class="col-10">
              <h3 class="mt-2 text-truncate"><%= booking.club.name %></h3>
              <div class="container-forced">
                <% if booking.user.photo.attached? %>
                  <%= cl_image_tag(booking.user.photo.key, height: 45, width: 45,:gravity=>"faces", crop: :fill, :class=>"rounded-circle ms-1 me-2 mb-3 mt-2") %>
                <% else %>
                  <%= cl_image_tag("avatar-vierge_dnx941", height: 45, width: 45,:gravity=>"faces", crop: :fill, :class=>"rounded-circle ms-1 me-2 mb-3 mt-2") %>
                <% end %>
                <%= link_to "#{booking.user.first_name} #{booking.user.last_name}", user_path(booking.user) %>
              </div>
              <p><strong>Début :</strong> <%= booking.start_date %></p>
              <p><strong>Fin :</strong> <%= booking.end_date %></p>
            </div>
            <div class="col-2 d-flex flex-column align-items-center justify-content-between pb-2">
              <%= link_to booking_accepted_path(booking) do%>
                <% if booking.accepted %>
                  <i class="fa-solid fa-check validated"></i>
                <% else %>
                  <i class="fa-solid fa-check unvalidated"></i>
                <% end %>
              <% end %>
              <%= link_to bookings_delete_path(booking), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} do%>
                <i class="fa-solid fa-trash"></i>
              <% end %>
            </div>
          </div>
          <%= link_to "validated", booking_validated_path(booking) %>
          <%= link_to "cancelled", booking_cancelled_path(booking) %>
          <%= link_to "declined", booking_declined_path(booking) %>

          <%= booking.status %>
        <% end %>
      <% end %>
    </div>
  <% end %>
</div>
